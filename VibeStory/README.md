# VibeStory - 关键词驱动的互动小说平台

VibeStory 是一个基于关键词的智能互动小说平台，通过简单的关键词组合，创造出丰富多彩的故事世界。

## 🎵 新增功能

### 音频系统
- **背景音乐**: 根据故事风格自动播放相应的背景音乐
- **环境音效**: 根据场景背景播放环境音效（森林、城市、太空等）
- **界面音效**: 按钮点击、页面切换、选择确认等交互音效
- **音频控制**: 完整的音频控制面板，支持静音、音量调节、独立开关

### 性能优化
- **虚拟滚动**: 大量选项时的性能优化
- **懒加载**: 图片和组件的按需加载
- **资源预加载**: 关键资源的预加载机制
- **缓存系统**: 智能缓存管理，提升响应速度
- **硬件加速**: CSS硬件加速优化
- **内存管理**: 自动清理过期缓存和资源

## 🚀 主要特点

### 核心功能
- **关键词驱动**: 只需输入几个关键词，即可生成完整故事
- **智能分支**: 基于AI的故事树生成，支持多路径选择
- **动态背景**: 根据故事内容自动切换场景背景
- **响应式设计**: 完美适配桌面端和移动端

### 交互体验
- **流畅动画**: 现代化的UI动画效果
- **实时反馈**: 即时的用户操作反馈
- **进度显示**: 故事生成进度可视化
- **错误处理**: 完善的错误处理和重试机制

### 技术特色
- **模块化架构**: 清晰的代码结构，易于维护和扩展
- **性能优化**: 多层次的性能优化策略
- **音频集成**: 完整的Web Audio API集成
- **本地存储**: 智能的本地数据缓存

## 🎮 使用方法

### 1. 创建故事
1. 输入关键词（用+连接），如：`末日废墟+机械义肢+失忆`
2. 选择故事风格：冒险、科幻、奇幻、悬疑、浪漫
3. 设置难度等级（1-5级）
4. 选择背景场景（可选）
5. 点击"开始故事"

### 2. 音频控制
- **静音/取消静音**: 点击🔊按钮
- **音量调节**: 拖动音量滑块
- **音频设置**: 点击⚙️按钮打开设置面板
  - 背景音乐开关
  - 环境音效开关
  - 界面音效开关

### 3. 游戏界面
- **故事内容**: 查看当前故事段落
- **选择选项**: 点击选项继续故事
- **侧边栏**: 查看故事结构、角色关系等信息
- **导出功能**: 导出完整故事文本

## 🛠️ 技术栈

### 前端技术
- **HTML5**: 语义化结构
- **CSS3**: 现代化样式，动画效果
- **JavaScript ES6+**: 模块化开发
- **Web Audio API**: 音频处理
- **Intersection Observer**: 懒加载实现

### 性能优化
- **虚拟滚动**: 大量数据渲染优化
- **懒加载**: 按需加载资源
- **缓存策略**: 智能缓存管理
- **硬件加速**: CSS 3D变换
- **内存管理**: 自动资源清理

### 音频系统
- **背景音乐**: 根据故事风格动态切换
- **环境音效**: 场景相关的环境音效
- **界面音效**: 用户交互反馈音效
- **音频控制**: 完整的音频管理界面

## 📱 响应式支持

- **桌面端**: 完整功能体验
- **平板端**: 优化的触摸交互
- **移动端**: 简化的界面布局
- **高对比度**: 无障碍访问支持
- **减少动画**: 尊重用户偏好设置

## 🔧 配置说明

### API配置
```javascript
const API_CONFIG = {
    url: 'https://api.deepseek.com/v1/chat/completions',
    apiKey: 'your-api-key',
    maxRetries: 3,
    retryDelay: 1000
};
```

### 音频配置
```javascript
const AUDIO_CONFIG = {
    backgroundMusic: {
        adventure: { url: 'music/adventure.mp3', volume: 0.3 },
        scifi: { url: 'music/scifi.mp3', volume: 0.3 }
    },
    soundEffects: {
        buttonClick: { url: 'sounds/click.wav', volume: 0.5 }
    }
};
```

### 性能配置
```javascript
const PERFORMANCE_CONFIG = {
    virtualScroll: {
        itemHeight: 60,
        visibleItems: 5,
        bufferSize: 2
    },
    lazyLoad: {
        threshold: 0.1,
        rootMargin: '50px'
    }
};
```

## 🎯 性能指标

- **首屏加载**: < 2秒
- **交互响应**: < 100ms
- **内存使用**: < 50MB
- **音频延迟**: < 50ms
- **缓存命中率**: > 80%

## 🔮 未来计划

- [ ] 角色系统完善
- [ ] 记忆碎片系统
- [ ] 社交分享功能
- [ ] 多语言支持
- [ ] 离线模式
- [ ] 自定义主题

## 📄 许可证

MIT License

## 🤝 贡献

欢迎提交Issue和Pull Request！

---

**VibeStory** - 让每个关键词都成为故事的开始 ✨

## 🎵 音频系统

### 背景音乐
- **智能主题检测**: 根据关键词自动选择最合适的背景音乐
- **风格分类**: 冒险、科幻、奇幻、悬疑、浪漫等不同风格
- **动态切换**: 根据故事内容自动切换主题音乐
- **音量控制**: 独立的主音量和静音控制

### 主题音乐系统
系统包含10种专业主题音乐，每种都有特定的关键词触发：

1. **末日主题** 🌋 - 末日、废墟、灾难、毁灭、末世、废土
2. **机械主题** ⚙️ - 机械、义肢、机器人、齿轮、蒸汽、工业
3. **失忆主题** 🧠 - 失忆、记忆、遗忘、回忆、过去、身份
4. **魔法主题** ✨ - 魔法、法术、咒语、巫师、精灵、龙
5. **战争主题** ⚔️ - 战争、战斗、军队、武器、战场、将军
6. **海洋主题** 🌊 - 海洋、海盗、船只、深海、岛屿、宝藏
7. **太空主题** 🚀 - 太空、宇宙、星球、飞船、星际、外星
8. **古代主题** 🏛️ - 古代、王朝、皇帝、宫殿、历史、传统
9. **现代都市主题** 🏙️ - 都市、城市、现代、科技、商业、生活
10. **自然主题** 🌲 - 自然、森林、山脉、河流、动物、生态

### 智能音乐选择
- **关键词匹配**: 分析用户输入的关键词，自动选择最匹配的主题音乐
- **内容检测**: 实时分析故事内容，动态切换音乐主题
- **优先级系统**: 主题音乐优先于风格背景音乐
- **无缝切换**: 平滑的音乐过渡效果

### 音效系统
- **UI音效**: 按钮点击、页面切换、选择确认等
- **主题音效**: 魔法咒语、剑击声、脚步声、开门声、雷声等
- **环境音效**: 森林、城市、太空、海洋、沙漠、山脉等
- **上下文音效**: 根据故事内容自动播放相关音效

### 音频控制面板
- **音乐信息显示**: 当前播放的音乐类型、名称和描述
- **可视化效果**: 音乐播放时的动态可视化
- **主题建议**: 可点击的主题音乐建议列表
- **播放控制**: 暂停、恢复、停止等基本控制
- **设置保存**: 音频设置自动保存到本地存储